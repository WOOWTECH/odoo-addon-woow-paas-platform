---
name: Configuration & Launch UI
status: closed
created: 2026-02-01T17:23:19Z
updated: 2026-03-01T14:03:58Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/9
depends_on: [7]
parallel: true
conflicts_with: [8, 10, 11, 12]
---

# Task: Configuration & Launch UI

## Description

建立應用配置頁面，讓用戶可以設定應用名稱、subdomain、Helm values，並啟動部署。

## Acceptance Criteria

- [ ] AppConfigurationPage 頁面建立
- [ ] HelmValueForm 元件建立（動態表單）
- [ ] 應用名稱和 Reference ID 輸入
- [ ] Subdomain 輸入與驗證
- [ ] 必填/選填 Helm values 表單
- [ ] Advanced toggle 顯示選填設定
- [ ] Launch 按鈕觸發部署
- [ ] 部署狀態輪詢與顯示
- [ ] 驗證錯誤提示

## Technical Details

### Router 更新

```javascript
'#/workspaces/:id/services/configure/:templateId': 'configure',
```

### AppConfigurationPage (`src/static/src/paas/pages/configure/`)

```
pages/configure/
├── AppConfigurationPage.js
├── AppConfigurationPage.xml
└── AppConfigurationPage.scss
```

**Sections:**

1. **Header**: App icon + name + description
2. **General Settings**: Name, Reference ID (auto-generated)
3. **Network & Domain**: Subdomain input (`xxx.woowtech.io`)
4. **Helm Values**: Dynamic form based on template's helm_value_specs
5. **Footer**: Cancel, Launch Application buttons

### HelmValueForm (`src/static/src/paas/components/config/`)

```
components/config/
├── HelmValueForm.js
├── HelmValueForm.xml
└── HelmValueForm.scss
```

**支援的欄位類型:**

- `text`: 文字輸入
- `password`: 密碼輸入
- `number`: 數字輸入
- `boolean`: checkbox
- `select`: 下拉選單

**Props:**

```javascript
static props = {
    specs: Object,     // { required: [], optional: [] }
    values: Object,    // current values
    onUpdate: Function,
    showAdvanced: Boolean,
};
```

### Subdomain 驗證

- 格式: `^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$`
- 唯一性檢查（API call）
- 即時驗證 + 錯誤提示

### 部署流程 UI

1. 點擊 Launch
2. 顯示 loading spinner
3. 輪詢狀態 (每 5 秒)
4. 成功：導航到 ServiceDetailPage
5. 失敗：顯示錯誤訊息

### cloud_service.js 擴展

```javascript
async createService(workspaceId, data) {
    return await jsonrpc(`/woow/api/workspaces/${workspaceId}/services`, data);
},

async getServiceStatus(workspaceId, serviceId) {
    return await jsonrpc(`/woow/api/workspaces/${workspaceId}/services/${serviceId}`);
},

async validateSubdomain(subdomain) {
    return await jsonrpc('/woow/api/cloud/validate-subdomain', { subdomain });
},
```

## Dependencies

- [ ] Task 003: API 可用
- [ ] Task 004: 可從 Marketplace 導航過來

## Effort Estimate

- Size: M
- Hours: 8-12
- Parallel: true (can run with 004, 006-008)

## Definition of Done

- [ ] 頁面可正確載入 template 資訊
- [ ] 動態表單正確渲染所有欄位類型
- [ ] 驗證錯誤正確顯示
- [ ] Launch 成功後導航到 Detail 頁面
- [ ] Launch 失敗顯示錯誤訊息
- [ ] Advanced toggle 正常運作
