---
name: Documentation & Deployment
status: closed
created: 2026-02-01T17:23:19Z
updated: 2026-02-02T10:45:00Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/14
depends_on: [13]
parallel: false
conflicts_with: []
---

# Task: Documentation & Deployment

## Description

建立完整的文檔和部署指南，包含 PaaS Operator 部署說明、K8s 配置、故障排除。

## Acceptance Criteria

- [ ] PaaS Operator README 完成
- [ ] K8s 部署指南完成
- [ ] Odoo 模組設定說明
- [ ] API 文檔（OpenAPI/Swagger）
- [ ] 故障排除指南
- [ ] 開發者設定指南

## Technical Details

### PaaS Operator README (`extra/paas-operator/README.md`)

````markdown
# PaaS Operator

FastAPI service for managing Helm releases in Kubernetes.

## Quick Start

### Local Development

```bash
cd extra/paas-operator
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn src.main:app --reload
```
````

### Docker Build

```bash
docker build -t woowtech/paas-operator:latest .
docker run -p 8000:8000 -e API_KEY=your-key woowtech/paas-operator:latest
```

### Kubernetes Deployment

```bash
kubectl apply -f k8s/
```

## API Reference

See `/docs` or `/redoc` when running.

## Configuration

| Env Var      | Description            | Default  |
| ------------ | ---------------------- | -------- |
| API_KEY      | Authentication key     | required |
| LOG_LEVEL    | Logging level          | INFO     |
| HELM_TIMEOUT | Helm operation timeout | 300s     |

## Security

- API Key authentication required
- Only operates on `paas-ws-*` namespaces
- ClusterIP service (internal only)

````

### K8s 部署指南 (`docs/deployment/k8s-setup.md`)

```markdown
# Kubernetes Deployment Guide

## Prerequisites
- K3s cluster running
- kubectl configured
- Cloudflare DNS setup

## Step 1: Deploy PaaS Operator
```bash
# Create secrets
kubectl create secret generic paas-operator-secrets \
  --from-literal=api-key=$(openssl rand -hex 32) \
  -n paas-system

# Deploy
kubectl apply -f extra/paas-operator/k8s/
````

## Step 2: Configure Odoo

1. Go to Settings → General Settings → Woow PaaS
2. Set PaaS Operator URL: `http://paas-operator.paas-system.svc:8000`
3. Set API Key: (from secret created above)

## Step 3: Verify

```bash
# Check operator is running
kubectl get pods -n paas-system

# Test health endpoint
kubectl exec -it <odoo-pod> -- curl http://paas-operator.paas-system.svc:8000/health
```

## Cloudflare Origin CA Setup

1. Generate Origin Certificate in Cloudflare dashboard
2. Create TLS secret:

```bash
kubectl create secret tls cloudflare-origin-tls \
  --cert=origin.pem \
  --key=origin.key \
  -n default
```

## Troubleshooting

See [Troubleshooting Guide](./troubleshooting.md)

````

### 故障排除指南 (`docs/deployment/troubleshooting.md`)

```markdown
# Troubleshooting Guide

## Common Issues

### Service stuck in "Deploying" state
1. Check operator logs: `kubectl logs -l app=paas-operator -n paas-system`
2. Check Helm release: `helm list -n paas-ws-{id}`
3. Check pod events: `kubectl describe pod -n paas-ws-{id}`

### Connection refused to PaaS Operator
1. Verify service is running: `kubectl get svc paas-operator -n paas-system`
2. Check Odoo config: Settings → Woow PaaS → Operator URL
3. Test from Odoo pod: `curl http://paas-operator.paas-system.svc:8000/health`

### Ingress not working
1. Check Ingress resource: `kubectl get ingress -n paas-ws-{id}`
2. Verify Traefik logs: `kubectl logs -l app.kubernetes.io/name=traefik -n kube-system`
3. Check Cloudflare DNS: `nslookup {subdomain}.woowtech.io`

### Helm install fails
1. Check operator logs for error message
2. Verify RBAC permissions: `kubectl auth can-i create deployments -n paas-ws-{id} --as system:serviceaccount:paas-system:paas-operator`
3. Check namespace quota: `kubectl describe quota -n paas-ws-{id}`
````

### API 文檔

PaaS Operator 自動生成 OpenAPI 文檔：

- Swagger UI: `/docs`
- ReDoc: `/redoc`
- OpenAPI JSON: `/openapi.json`

### 更新 CLAUDE.md

加入 Cloud Services 相關說明到 `CLAUDE.md`。

## Dependencies

- [ ] Task 009: 測試完成確保功能穩定

## Effort Estimate

- Size: S
- Hours: 4-6
- Parallel: false

## Definition of Done

- [ ] README 清楚說明如何開發和部署
- [ ] K8s 部署指南可成功部署
- [ ] 故障排除指南涵蓋常見問題
- [ ] API 文檔可存取且準確
- [ ] CLAUDE.md 已更新
