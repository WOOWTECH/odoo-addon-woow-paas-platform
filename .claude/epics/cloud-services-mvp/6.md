---
name: Odoo Models & Seed Data
status: open
created: 2026-02-01T17:23:19Z
updated: 2026-02-01T17:39:37Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/6
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Odoo Models & Seed Data

## Description

建立 Cloud Services 的 Odoo 資料模型：`CloudAppTemplate`（應用程式目錄）和 `CloudService`（已部署服務實例），並建立初始應用程式的 seed data。

## Acceptance Criteria

- [ ] `CloudAppTemplate` model 建立完成，包含所有必要欄位
- [ ] `CloudService` model 建立完成，包含所有必要欄位
- [ ] Security rules (ir.model.access.csv) 設定完成
- [ ] Seed data 包含至少 3 個初始應用（PostgreSQL, n8n, Redis）
- [ ] Model 可透過 Odoo ORM 正常 CRUD

## Technical Details

### CloudAppTemplate Model (`src/models/cloud_app_template.py`)

```python
class CloudAppTemplate(models.Model):
    _name = 'woow_paas_platform.cloud_app_template'
    _description = 'Cloud Application Template'

    # Basic Info
    name = fields.Char(required=True)
    slug = fields.Char(index=True)
    icon = fields.Binary()
    description = fields.Char()  # Short (~100 chars)
    full_description = fields.Text()
    category = fields.Selection([
        ('ai_llm', 'AI & LLM'),
        ('automation', 'Automation'),
        ('database', 'Database'),
        ('analytics', 'Analytics'),
        ('devops', 'DevOps'),
        ('web', 'Web'),
        ('container', 'Container'),
    ])
    tags = fields.Char()  # JSON array
    monthly_price = fields.Float()
    documentation_url = fields.Char()

    # Helm Chart Configuration
    helm_repo_url = fields.Char(required=True)
    helm_chart_name = fields.Char(required=True)
    helm_chart_version = fields.Char(required=True)
    helm_default_values = fields.Text()  # JSON
    helm_value_specs = fields.Text()  # JSON schema for user input

    # Service Configuration
    default_port = fields.Integer(default=80)
    ingress_enabled = fields.Boolean(default=True)

    # Resource Requirements
    min_vcpu = fields.Integer(default=1)
    min_ram_gb = fields.Float(default=1)
    min_storage_gb = fields.Integer(default=5)

    is_active = fields.Boolean(default=True)
```

### CloudService Model (`src/models/cloud_service.py`)

```python
class CloudService(models.Model):
    _name = 'woow_paas_platform.cloud_service'
    _description = 'Cloud Service Instance'

    # Relationships
    workspace_id = fields.Many2one('woow_paas_platform.workspace', required=True, ondelete='cascade')
    template_id = fields.Many2one('woow_paas_platform.cloud_app_template', required=True)

    # Identity
    name = fields.Char(required=True)
    reference_id = fields.Char(index=True, readonly=True)  # Immutable
    deployment_id = fields.Char()

    # State
    state = fields.Selection([
        ('pending', 'Pending'),
        ('deploying', 'Deploying'),
        ('running', 'Running'),
        ('error', 'Error'),
        ('upgrading', 'Upgrading'),
        ('deleting', 'Deleting'),
    ], default='pending')
    error_message = fields.Text()

    # Network
    subdomain = fields.Char()
    custom_domain = fields.Char()
    internal_port = fields.Integer()

    # Helm Release Info
    helm_release_name = fields.Char()
    helm_namespace = fields.Char()
    helm_values = fields.Text()  # JSON
    helm_revision = fields.Integer(default=1)
    helm_chart_version = fields.Char()

    # Resources
    allocated_vcpu = fields.Integer()
    allocated_ram_gb = fields.Float()
    allocated_storage_gb = fields.Integer()

    # Timestamps
    deployed_at = fields.Datetime()
    last_upgraded_at = fields.Datetime()
```

### Seed Data (`src/data/cloud_app_templates.xml`)

包含 PostgreSQL, n8n, Redis 的 Helm chart 配置

### Files to Create/Modify
- `src/models/cloud_app_template.py` (新建)
- `src/models/cloud_service.py` (新建)
- `src/models/__init__.py` (修改 - 加入 imports)
- `src/security/ir.model.access.csv` (修改 - 加入權限)
- `src/data/cloud_app_templates.xml` (新建)
- `src/__manifest__.py` (修改 - 加入 data files)

## Dependencies

- [ ] 無（可與 Task 001 平行進行）

## Effort Estimate

- Size: M
- Hours: 8-12
- Parallel: true (can run alongside Task 001)

## Definition of Done

- [ ] Models 可在 Odoo 中正常建立和查詢
- [ ] Security rules 允許適當的用戶存取
- [ ] Seed data 成功載入 3 個應用模板
- [ ] Module update 不會產生錯誤
