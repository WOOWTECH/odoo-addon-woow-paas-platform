---
name: Add OpenAI Compatible type and form view
status: closed
created: 2026-02-21T15:31:18Z
updated: 2026-02-21T15:47:00Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/80
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Add OpenAI Compatible type and form view

## Description

在 `woow_paas_platform` addon 中擴充 `ai.config` 模型，新增 `openai_compatible` type 選項，並繼承 `ai_base_gt` 的 form view 加入 `api_base_url` 欄位，讓使用者可以設定任何 OpenAI 相容的 API endpoint。

## Acceptance Criteria

- [ ] `ai.config` 的 type selection 新增 "OpenAI Compatible" 選項
- [ ] AI Configurations form view 中，選擇 `openai_compatible` 時顯示 "API Base URL" 欄位
- [ ] API Base URL 欄位有 placeholder 提示（如 `https://api.openai.com/v1`）
- [ ] API Key 不限制格式（不強制 `sk-` 開頭）
- [ ] 部署後可在 Settings → AI → Configurations 中建立 OpenAI Compatible 設定
- [ ] `AIClient.from_assistant()` 正確讀取自訂 URL（已實作，需驗證）
- [ ] 現有 ChatGPT / OdooAI type 不受影響

## Technical Details

### 修改檔案

1. **`src/models/ai_config.py`** — 加入 `selection_add` 和 `ondelete`
   ```python
   type = fields.Selection(
       selection_add=[('openai_compatible', 'OpenAI Compatible')],
       ondelete={'openai_compatible': 'cascade'}
   )
   ```

2. **`src/views/ai_config_views.xml`** (新增) — 繼承 `ai_base_gt.view_ai_config_form`
   - 在 `api_key` 欄位後插入 `api_base_url` 欄位
   - `invisible` 條件：`type != 'openai_compatible'`
   - placeholder: `https://api.openai.com/v1`

3. **`src/__manifest__.py`** — `data` 列表加入 `views/ai_config_views.xml`

### 不需修改

- `ai_client.py` — `from_assistant()` line 119 已讀取 `config.api_base_url`
- `res_config_settings.py` — Settings 選 ai.config 時已可選所有 type
- `discuss_channel.py` — AI 回覆流程不受影響

## Dependencies

- [ ] `ai_base_gt` 模組已安裝
- [ ] Docker 開發環境可用

## Effort Estimate

- Size: XS
- Hours: 1
- Parallel: true

## Definition of Done

- [ ] Code implemented (model + view + manifest)
- [ ] Deploy to local Odoo and verify
- [ ] Create OpenAI Compatible config, fill URL + API Key, save
- [ ] Test Connection button works
- [ ] Existing ChatGPT config unaffected
