---
name: Refactor res_config_settings to use ai.config + ai.assistant
status: open
created: 2026-02-21T16:13:06Z
updated: 2026-02-20T16:21:24Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/78
depends_on: [77]
parallel: true
conflicts_with: []
---

# Task: Refactor res_config_settings to use ai.config + ai.assistant

## Description

更新 `res_config_settings.py` 和對應的 views XML，將 AI 配置從自建 `ai_provider` 改為 `ai.config` + `ai.assistant`。

## Acceptance Criteria

- [ ] `woow_ai_provider_id` 欄位移除，改為 `woow_ai_config_id`（M2O → `ai.config`）
- [ ] 新增 `woow_ai_assistant_id`（M2O → `ai.assistant`）作為預設助手
- [ ] `set_values()` 邏輯更新：不再同步 agent provider，改為確保預設 assistant 有 config
- [ ] `action_test_ai_connection` 改用 `AIClient.from_assistant()` 測試連線
- [ ] `res_config_settings_views.xml` 更新：顯示 `ai.config` 和 `ai.assistant` 選擇器
- [ ] Settings 頁面可正常儲存和載入

## Technical Details

**修改檔案：**
- `src/models/res_config_settings.py`:
  - 移除 `woow_ai_provider_id` 欄位
  - 新增 `woow_ai_config_id = fields.Many2one('ai.config', config_parameter=...)`
  - 新增 `woow_ai_assistant_id = fields.Many2one('ai.assistant', config_parameter=...)`
  - `action_test_ai_connection`: 從 `woow_ai_assistant_id` 建立 `AIClient.from_assistant()`

- `src/views/res_config_settings_views.xml`:
  - 將 AI Provider 選擇改為 AI Configuration + AI Assistant 選擇
  - 保留 Test Connection 按鈕

**config_parameter 命名：**
- `woow_paas_platform.default_ai_config_id`
- `woow_paas_platform.default_ai_assistant_id`

## Dependencies

- [ ] Task 77 完成（`AIClient.from_assistant()` 可用）

## Effort Estimate

- Size: M
- Parallel: true（可與 Task 72、75 並行）
