---
name: E2E browser validation tests
status: open
created: 2026-02-21T16:13:06Z
updated: 2026-02-20T16:21:24Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/76
depends_on: [74]
parallel: false
conflicts_with: []
---

# Task: E2E browser validation tests

## Description

部署重構後的模組到測試環境，透過 Playwright 瀏覽器自動化執行 5 個端到端測試案例，驗證 AI 對話功能完整可用。

## Acceptance Criteria

- [ ] TC-1 通過：Portal AI Chat 發送訊息，收到 SSE streaming AI 回覆，author 為 ai.assistant partner
- [ ] TC-2 通過：多輪對話，AI 回覆包含上一輪上下文
- [ ] TC-3 通過：AI 連線狀態正常顯示（`/api/ai/connection-status`）
- [ ] TC-4 通過：Task Chat @mention AI 助手，收到回覆，author 為 ai.assistant partner
- [ ] TC-5 通過：Settings 頁面可選擇 ai.config 和 ai.assistant，連線測試成功

## Technical Details

**測試前置條件：**
1. 部署模組到測試環境（`deploy-local` 或 worktree docker）
2. 確認 `ai_base_gt` 和 `woow_paas_platform` 已安裝
3. 在後台建立 `ai.config`（填入真實 API Key、model）
4. 在後台建立 `ai.assistant`（關聯 config 和 context）
5. Settings 設定預設 AI assistant

**測試流程：**

**TC-1: Portal AI Chat — 基本對話**
1. Playwright 登入 Odoo
2. 導航至 `/woow` → AI Chat 頁面
3. 輸入「你好，請自我介紹」→ 送出
4. 等待 SSE streaming 完成
5. 驗證：回覆存在且非空
6. 驗證：回覆 author 不是 OdooBot / partner_root

**TC-2: Portal AI Chat — 多輪對話**
1. 延續 TC-1
2. 輸入「你記得我剛才問了什麼嗎？」→ 送出
3. 驗證：回覆包含「介紹」相關關鍵字（表示有上下文）

**TC-3: 連線狀態**
1. 進入 AI Chat 頁面
2. 驗證：連線狀態指示器顯示已連線

**TC-4: Task Chat @mention**
1. 確保有一個啟用 chat 的 Task
2. 導航至 Task Detail 頁面
3. 在 chat 輸入 `@WoowBot 你好`
4. 等待 AI 回覆出現
5. 驗證：回覆 author 為 WoowBot（ai.assistant partner）

**TC-5: Settings 配置**
1. 導航至 Settings → Woow PaaS
2. 驗證：可看到 AI Configuration 和 AI Assistant 選擇器
3. 選擇配置並儲存
4. 點擊 Test AI Connection
5. 驗證：成功通知出現

## Dependencies

- [ ] Task 74 完成（所有程式碼變更已完成）
- [ ] 測試環境可用（含真實 AI API Key）

## Effort Estimate

- Size: M
- Parallel: false（最終驗證步驟）
