---
name: Root Component and Hash Router
status: closed
created: 2026-01-13T17:39:27Z
updated: 2026-01-14T06:51:32Z
github: https://github.com/WOOWTECH/odoo-addons/issues/24
depends_on: [23]
parallel: false
conflicts_with: []
---

# Task: Root Component and Hash Router

## Description

建立 Root OWL 元件和簡易的 Hash Router 服務。Root 元件作為應用的頂層容器，Router 服務負責監聽 URL hash 變化並通知 Root 切換頁面。

## Acceptance Criteria

- [ ] 建立 `static/src/paas/root.js` Root 元件類別
- [ ] 建立 `static/src/paas/root.xml` Root 元件模板
- [ ] 建立 `static/src/paas/core/router.js` Hash Router 服務
- [ ] 更新 `app.js` 使用 `mountComponent` 掛載 Root
- [ ] Router 支援 5 個路由：dashboard, workspaces, deployments, billing, settings
- [ ] URL hash 變化時頁面名稱正確更新
- [ ] 預設路由為 `#/dashboard`

## Technical Details

### 檔案清單

1. **static/src/paas/core/router.js**
```javascript
/** @odoo-module **/
import { reactive } from "@odoo/owl";

const routes = [
    { path: "dashboard", name: "Dashboard" },
    { path: "workspaces", name: "Workspaces" },
    { path: "deployments", name: "Deployments" },
    { path: "billing", name: "Billing" },
    { path: "settings", name: "Settings" },
];

export const router = reactive({
    current: "dashboard",
    routes,

    init() {
        this.current = this.getRouteFromHash();
        window.addEventListener("hashchange", () => {
            this.current = this.getRouteFromHash();
        });
        if (!window.location.hash) {
            window.location.hash = "#/dashboard";
        }
    },

    getRouteFromHash() {
        const hash = window.location.hash.slice(2); // Remove "#/"
        const route = routes.find(r => r.path === hash);
        return route ? route.path : "dashboard";
    },

    navigate(path) {
        window.location.hash = `#/${path}`;
    },
});
```

2. **static/src/paas/root.js**
```javascript
/** @odoo-module **/
import { Component, useState, onMounted } from "@odoo/owl";
import { router } from "./core/router";

export class Root extends Component {
    static template = "woow_paas_platform.Root";
    static props = {};

    setup() {
        this.router = useState(router);
        onMounted(() => {
            this.router.init();
        });
    }
}
```

3. **static/src/paas/root.xml**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="woow_paas_platform.Root">
        <div class="o_woow_app">
            <h1>Current Page: <t t-esc="router.current"/></h1>
            <nav>
                <t t-foreach="router.routes" t-as="route" t-key="route.path">
                    <button t-on-click="() => router.navigate(route.path)"
                            t-att-class="{'active': router.current === route.path}">
                        <t t-esc="route.name"/>
                    </button>
                </t>
            </nav>
        </div>
    </t>
</templates>
```

4. **static/src/paas/app.js (更新)**
```javascript
/** @odoo-module **/
import { whenReady } from "@odoo/owl";
import { mountComponent } from "@web/env";
import { Root } from "./root";

whenReady(() => mountComponent(Root, document.body));
```

### 驗證步驟
1. 更新模組
2. 訪問 `/woow`
3. 應看到導航按鈕和當前頁面名稱
4. 點擊按鈕，URL 應變化（如 `#/workspaces`）
5. 頁面名稱應隨之更新
6. 瀏覽器前進/後退應正常工作

## Dependencies

- [ ] Task 001 完成（基礎設施）

## Effort Estimate

- Size: S
- Hours: 1-2
- Parallel: false (後續任務依賴此 Router)

## Definition of Done

- [ ] Root 元件正確渲染
- [ ] Router 監聽 hashchange 事件
- [ ] 導航按鈕可切換路由
- [ ] 瀏覽器前進/後退正常
- [ ] 預設重定向到 `#/dashboard`
