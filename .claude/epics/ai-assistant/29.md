---
name: AI Chat Full Page + Workspace Integration
status: closed
created: 2026-02-09T16:35:07Z
updated: 2026-02-10T06:11:51Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/29
depends_on: [31]
parallel: true
conflicts_with: []
---

# Task: AI Chat Full Page + Workspace Integration

## Description

建立獨立的 AI Chat 全頁路由 (`#/ai-assistant/chat/:conversationId`)，讓使用者可以在全頁模式下使用 AI 對話。在 Settings 後台新增 AI Provider 連線測試按鈕。建立混合模式設定 UI（auto_reply toggle）。可選：整合 AiChat 到 Workspace Detail 頁面。

## Acceptance Criteria

- [ ] 全頁 Chat 路由運作：導航到 `#/ai-assistant/chat/:conversationId` 顯示全頁 AiChat
- [ ] 全頁模式的 AiChat layout：
  - [ ] 頂部 header：channel 名稱 + 返回按鈕
  - [ ] 中間：AiChat 元件（佔滿可用空間）
- [ ] Settings 連線測試按鈕：
  - [ ] 在 res_config_settings_views.xml 的 AI Provider 區塊新增「Test Connection」按鈕
  - [ ] 按鈕呼叫 `action_test_ai_connection` 方法
  - [ ] 方法使用 ai_client 發送測試請求，回傳成功/失敗
- [ ] 混合模式 UI：
  - [ ] Channel / Task 層級的 auto_reply toggle
  - [ ] 「Automatic」= 每則訊息自動 AI 回覆
  - [ ] 「Mention Only」= 只有 @ mention 時才回覆
- [ ] （可選）Workspace Detail 頁面整合 AiChat sidebar/panel

## Technical Details

- 全頁 Chat 路由已在 Task 004 的 router 中定義，此 task 實作對應的頁面元件
- 可建立一個薄 wrapper component `AiChatPage` 包裹 AiChat + header
- 連線測試：`res_config_settings.py` 新增 `action_test_ai_connection()` 方法
  - 使用 `ai_client.chat_completion()` 發送簡單測試訊息
  - 成功：回傳 notification「Connection successful」
  - 失敗：回傳 notification「Connection failed: {error}」
- auto_reply toggle：前端在 Chat 區域上方顯示切換開關

### Files affected

- `src/static/src/paas/pages/ai-chat/AiChatPage.js` (create, thin wrapper)
- `src/static/src/paas/pages/ai-chat/AiChatPage.xml` (create)
- `src/models/res_config_settings.py` (edit - add test connection method)
- `src/views/res_config_settings_views.xml` (edit - add test button)
- `src/static/src/paas/root.js` (edit - add AiChatPage import)
- `src/static/src/paas/root.xml` (edit - add route mapping)

## Dependencies

- [ ] Task 005: 需要 AiChat 元件

## Effort Estimate

- Size: S
- Hours: 2-4
- Parallel: true (only depends on AiChat)

## Definition of Done

- [ ] 全頁 Chat 模式可正常使用
- [ ] 連線測試按鈕運作（成功/失敗通知）
- [ ] auto_reply toggle UI 運作
