---
name: Auto-initialize project stages in backend
status: closed
created: 2026-02-10T15:53:50Z
updated: 2026-02-11T02:05:26Z
github: https://github.com/WOOWTECH/odoo-addon-woow-paas-platform/issues/53
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Auto-initialize project stages in backend

## Description

When a project has no `project.task.type` stages configured, the kanban view shows a blank page. Fix this by adding auto-initialization logic in the backend: when `_get_project_stages()` returns empty, automatically create default stages (New, In Progress, Done) and associate them with the project.

## Acceptance Criteria

- [ ] When fetching stages for a project with no stages, default stages are auto-created
- [ ] Default stages: "New" (sequence=1), "In Progress" (sequence=5), "Done" (sequence=10)
- [ ] Stages are properly associated with the project via `project_ids` many2many field
- [ ] Subsequent calls return the same stages (no duplicates)
- [ ] Existing projects with stages are not affected

## Technical Details

**File**: `src/controllers/ai_assistant.py`

1. Modify `_get_project_stages()` (line 622-635):
   - After searching for stages, if result is empty, call a new `_ensure_default_stages()` helper
   - `_ensure_default_stages(project_id)` creates 3 default `project.task.type` records
   - Use `project.task.type` model's `create()` with `project_ids = [(4, project_id)]` to link to the project
   - Return the newly created stages

2. Default stages definition:
   ```python
   DEFAULT_STAGES = [
       {'name': 'New', 'sequence': 1},
       {'name': 'In Progress', 'sequence': 5},
       {'name': 'Done', 'sequence': 10},
   ]
   ```

3. Check if global stages with same names already exist to avoid duplicates — if they exist, just link them to the project instead of creating new ones.

## Dependencies

- [ ] None — this is the first task

## Effort Estimate

- Size: S
- Hours: 0.5
- Parallel: false (Task 002 and 003 depend on this)

## Definition of Done

- [ ] Code implemented
- [ ] Projects without stages now auto-receive default stages
- [ ] Existing projects with stages remain unchanged
